/*
 * Button_press_toggle_led.c
 *
 *  Created on: Feb 15, 2026
 *      Author: My PC
 */



#include "stm32_f446xx.h"
#include "stm32_f446xx_gpio_driver.h"




int main (void){
	GPIO_Handle_t GPIO_LED;
	GPIO_LED.pGPIOx = GPIOA;
	GPIO_LED.GPIO_PinConfig.GPIO_PinNumber= GPIO_PIN_NO_5;
	GPIO_LED.GPIO_PinConfig.GPIO_PinOPType= 0;
	GPIO_LED.GPIO_PinConfig.GPIO_PinMode= GPIO_MODE_OUTPUT;
	GPIO_LED.GPIO_PinConfig.GPIO_PinSpeed = GPIO_SPEED_FAST;
	GPIO_LED.GPIO_PinConfig.GPIO_PinPuPdControl = GPIO_PUPD_NO;

	GPIO_Init(&GPIO_LED);

	GPIO_Handle_t BTN_1;
	BTN_1.pGPIOx = GPIOC;
	BTN_1.GPIO_PinConfig.GPIO_PinNumber = GPIO_PIN_NO_13;
	BTN_1.GPIO_PinConfig.GPIO_PinOPType= 0;
	BTN_1.GPIO_PinConfig.GPIO_PinMode= GPIO_MODE_INPUT;
	BTN_1.GPIO_PinConfig.GPIO_PinSpeed= GPIO_SPEED_FAST;
	BTN_1.GPIO_PinConfig.GPIO_PinPuPdControl=GPIO_PUPD_NO;
	GPIO_Init(&BTN_1);



	uint8_t led_state = 0;       // LED initially OFF
	uint8_t prev_btn_state = 1;  // assume button released at start

	while(1)
	{
	    uint8_t BTN_1_STATE = GPIO_ReadFromInputPin(GPIOC, GPIO_PIN_NO_13);

	    // Detect transition: released (1) -> pressed (0)
	    if (BTN_1_STATE == 0 && prev_btn_state == 1)
	    {
	        // Toggle LED state
	        led_state = !led_state;
	        GPIO_WriteToOutputPin(GPIOA, GPIO_PIN_NO_5, led_state);
	    }

	    // Update history
	    prev_btn_state = BTN_1_STATE;
	}
